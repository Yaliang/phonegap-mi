<!DOCTYPE html> 
<html>
<head>
	<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>觅校缘</title>
    <link rel="icon" sizes="192x192" href="./content/material-design/png/m-192.png">
    <link rel="apple-touch-icon" href="./content/material-design/png/m-192.png">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="./script/jquery/mobile/jquery.mobile-1.4.5.min.css" />
	<link rel="stylesheet" href="index.css" />
    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="cordova_plugins.js"></script>
    <script type="text/javascript" src="./plugins/com.phonegap.plugins.PushPlugin/www/PushNotification.js"></script>
	<script src="./script/jquery/jquery-1.11.1.min.js"></script>
	<script src="./script/jquery/mobile/jquery.mobile-1.4.5.min.js"></script>
	<script src="./script/parse/parse-1.3.2.min.js"></script>
	<!--<script src="./script/parse/parse-1.3.2.js"></script>-->
	<script src="./script/parse/query.js"></script>
	<script src="./script/cache.js"></script>
	<script src="./script/functions.js"></script>
	<script src="./script/native-functions.js"></script>
</head>

<body>

	<!-- Page for signup -->
	<div data-role="page" id="page-signup" data-title="觅校缘">

		<div data-role="header">
			<h1>Sign Up</h1>
			<a href="#page-login" class="ui-btn-right ui-btn ui-btn-inline ui-corner-all">Log In</a>
		</div><!-- header -->

		<div role="main" class="ui-content">
			<form style='padding: 1em ' id='signup-form'>
				<label for="username">Name:</label>
				<input type="text" data-clear-btn="true" name="username" id="signup-name" value="">
				<label for="useremail">Email:</label>
				<input type="email" data-clear-btn="true" name="useremail" id="signup-email" value="">
				<label for="userpassword">Password:</label>
				<input type="password" data-clear-btn="ture" name="userpassword" id="signup-password" value="" autocomplete="off">
				<div id="signup-error"></div>
				<button class="ui-btn" onclick="signup();">Sign Up</button>
			</form>
		</div><!-- /content -->

		<div data-role="footer" data-position="fixed" data-tap-toggle="false">
		</div><!-- /footer -->
	</div><!-- /page -->

	<!-- Page for login -->
	<div data-role="page" id="page-login" data-title="觅校缘">

		<div data-role="header">
			<h1>Log In</h1>
			<a href="#page-signup" class="ui-btn-right ui-btn ui-btn-inline ui-corner-all">Sign Up</a>
		</div><!-- header -->

		<div role="main" class="ui-content">
			<form style='padding: 1em ' id='login-form'>
				<label for="useremail">Email:</label>
				<input type="email" data-clear-btn="true" name="useremail" id="login-email" value="">
				<label for="userpassword">Password:</label>
				<input type="password" data-clear-btn="ture" name="userpassword" id="login-password" value="" autocomplete="off">
				<div id="login-error"></div>
				<button class="ui-btn" onclick="login();">Log In</button>
			</form>
		</div><!-- /content -->

		<div data-role="footer" data-position="fixed" data-tap-toggle="false">
		</div><!-- /footer -->
	</div><!-- /page -->

	<!-- Page for displaying the list of events -->
	<div data-role="page" id="page-event" data-title="觅校缘">

		<div data-role="header" data-position="fixed" data-tap-toggle="false">
			<h1>Activities</h1>
			<a href="#" class="ui-btn-right ui-btn ui-btn-inline ui-corner-all" id="ui-icon-custom-right-top-more" onclick="displayEventMoreOption();"></a>
			<!--
				<a href="#page-event-create" class="ui-btn-right ui-btn ui-btn-inline ui-corner-all" onclick="$('#event-create-button').bind('click',function(){createUserEvent();});">Create</a>
				<a href="#page-event-my-event" class="ui-btn-left ui-btn ui-btn-inline ui-corner-all" onclick="pullMyEvent();">My Event</a>
			-->
		</div><!-- /header -->

		<div role="main" class="ui-content" id="event-content">
		</div><!-- /content -->

		<div data-role="footer" class="nav-glyphish-example" data-position="fixed" data-tap-toggle="false">
			<div data-role="navbar" class="nav-glyphish-example" data-grid="c">
			<ul>
				<li><a href="#page-event" data-transition="none" class="event-active-custom" id="event" onclick="pullUserEvent();">Activity</a></li>
				<li><a href="#page-friend" data-transition="none" id="friend" onclick="pullMyFriendList();">Friend</a></li>
				<li><a href="#page-chat" data-transition="none" id="chat" onclick="pullMyChat();">Chat</a></li>
				<li><a href="#page-setting" data-transition="none" id="setting">Setting</a></li>
			</ul>
			</div>
		</div><!-- /footer -->
		<ul class='event-page-right-top-options' style='display: none;'>
			<li><a href='#page-event-create' id='event-page-right-top-option-1'>Create</a></li>
			<li><a href='#page-event-my-event' id='event-page-right-top-option-2' onclick='pullMyEvent();'>My Activities</a></li>
		</ul>
		<div class='options-hidden-cover-layer' style='display: none;'></div>
	</div><!-- /page -->

	<!-- Page for displaying the list of my events -->
	<div data-role="page" id="page-event-my-event" data-title="觅校缘">

		<div data-role="header">
			<h1>Activities</h1>
			<a data-rel="back" href="#page-event" class="ui-btn-left ui-btn ui-btn-inline ui-corner-all">Back</a>
		</div><!-- /header -->

		<div role="main" class="ui-content" id="my-event-content">
		</div><!-- /content -->

		<div data-role="footer" data-position="fixed" data-tap-toggle="false">
		</div><!-- /footer -->
	</div><!-- /page -->

	<!-- Page for creating a new event -->
	<div data-role="page" id="page-event-create" data-title="觅校缘">

		<div data-role="header">
			<h1>Create Activity</h1>
			<a href="#page-event" class="ui-btn-left ui-btn ui-btn-inline ui-corner-all">Cancel</a>
		</div><!-- /header -->

		<div role="main" class="ui-content">
			<form style='padding: 1em '>
				<label for="eventtitle">Title:</label>
				<input type="text" data-clear-btn="true" name="eventtitle" id="event-create-title" value="">
				<label for="eventlocation">Location:</label>
				<input type="text" data-clear-btn="ture" name="eventlocation" id="event-create-location" value="">
				<label for="eventstarttime">Start Time:</label>
				<input type="datetime-local" data-clear-btn="ture" name="eventstarttime" id="event-create-start-time" value="">
				<label for="eventendtime">End Time:</label>
				<input type="datetime-local" data-clear-btn="ture" name="eventendtime" id="event-create-end-time" value="">
				<label for="eventvisibility">Visibility:</label>
				<select name="eventvisibility" id="event-create-visibility" data-role="flipswitch" data-wrapper-class="custom-size-flipswitch-event-create-visibility" checked="">
					<option value="off">Friends</option>
					<option value="on" selected="">Public</option>
				</select>
				<!-- flyer will comming later 
					<label for="eventflyer">Flyer:</label>
					<input type="file" name="eventflyer" accept="image/*" capture>
				-->
				<!-- label of event will comming later 
				-->
				<label for="eventdescription">Description:</label>
				<textarea name="eventdescription" id="event-create-description"></textarea>
			</form>
			<div id="event-create-preview"></div>
			<div id="event-create-error"></div>
			<button id="event-create-button" class="ui-btn">Create</button>
		</div><!-- /content -->

		<div data-role="footer" data-position="fixed" data-tap-toggle="false">
		</div><!-- /footer -->
	</div><!-- /page -->

	<!-- Page for displaying the detail of an event -->
	<div data-role="page" id="page-event-detail" data-title="觅校缘" data-add-back-btn="true">

		<div data-role="header">
			<h1>Activity Detail</h1>
			<a data-rel="back" href="#page-event" class="ui-btn-left ui-btn ui-btn-inline ui-corner-all" onclick="$('#send-comment-bar').fadeOut()">Back</a>
		</div><!-- /header -->

		<div role="main" class="ui-content" id="event-detail-content">
		</div><!-- /content -->

		<div data-role="footer" data-position="fixed" data-tap-toggle="false" >
		</div><!-- /footer -->

	</div><!-- /page -->

	<!-- Page for displaying the friend list -->
	<div data-role="page" id="page-friend" data-title="觅校缘">

		<div data-role="header">
			<h1>Friends</h1>
			<a href="#page-people-near-by" class="ui-btn-left ui-btn ui-btn-inline ui-corner-all" onclick="listFriendNearBy()">Near By</a>
			<a href="#page-people-search" class="ui-btn-right ui-btn ui-btn-inline ui-corner-all" onclick="bindSearchAutocomplete()">Search</a>
		</div><!-- /header -->

		<div role="main" class="ui-content">
			<a href="#page-my-friend-requests" id="new-friend-requests-btn" class="ui-btn" onclick="pullMyFriendRequests();">New Friend Requests<span id="new-friend-requests-number" class="ui-li-count"></span></a>
			<ul id='friend-list' class='ui-listview ui-listview-inset ui-corner-all ui-shadow'>
			</ul>
		</div><!-- /content -->

		<div data-role="footer" class="nav-glyphish-example" data-position="fixed" data-tap-toggle="false">
			<div data-role="navbar" class="nav-glyphish-example" data-grid="c">
			<ul>
				<li><a href="#page-event" data-transition="none" id="event" onclick="pullUserEvent();">Activity</a></li>
				<li><a href="#page-friend" data-transition="none" class="friend-active-custom" id="friend" onclick="pullMyFriendList();">Friend</a></li>
				<li><a href="#page-chat" data-transition="none" id="chat" onclick="pullMyChat();">Chat</a></li>
				<li><a href="#page-setting" data-transition="none" id="setting">Setting</a></li>
			</ul>
			</div>
		</div><!-- /footer -->
	</div><!-- /page -->

	<!-- Page for displaying the people near by -->
	<div data-role="page" id="page-people-near-by" data-title="觅校缘">

		<div data-role="header">
			<h1>People</h1>
			<a data-rel="back" href="#page-friend" class="ui-btn-left ui-btn ui-btn-inline ui-corner-all" onclick="stopGeoWatch()">Back</a>
		</div><!-- /header -->

		<div role="main" class="ui-content">
		</div><!-- /content -->

		<div data-role="footer" class="nav-glyphish-example" data-position="fixed" data-tap-toggle="false">
		</div><!-- /footer -->
	</div><!-- /page -->

	<!-- Page for searching user by email/name/maybe others -->
	<div data-role="page" id="page-people-search" data-title="觅校缘">

		<div data-role="header">
			<h1>People</h1>
			<a data-rel="back" href="#page-friend" class="ui-btn-left ui-btn ui-btn-inline ui-corner-all" onclick="unbindSearchAutocomplete()">Back</a>
		</div><!-- /header -->

		<div role="main" class="ui-content">
			<form class="ui-filterable">
				<input id="user-autocomplete-input" data-type="search" placeholder="Email/Name">
			</form>
			<ul id="user-autocomplete-list" data-role="listview" data-inset="true" data-filter="true" data-input="#user-autocomplete-input"></ul>
		</div><!-- /content -->

		<div data-role="footer" data-position="fixed" data-tap-toggle="false">
		</div><!-- /footer -->
	</div><!-- /page -->

	<!-- Page for displaying all new friend requests -->
	<div data-role="page" id="page-my-friend-requests" data-title="觅校缘">

		<div data-role="header">
			<h1>People</h1>
			<a data-rel="back" href="#page-friend" class="ui-btn-left ui-btn ui-btn-inline ui-corner-all" onclick="pullMyFriendList();">Back</a>
		</div><!-- /header -->

		<div role="main" class="ui-content">
		</div><!-- /content -->

		<div data-role="footer" data-position="fixed" data-tap-toggle="false">
		</div><!-- /footer -->
	</div><!-- /page -->

	<!-- Page for displaying the chat list -->
	<div data-role="page" id="page-chat" data-title="觅校缘">

		<div data-role="header">
			<h1>Chats</h1>
		</div><!-- /header -->

		<div role="main" class="ui-content">
		</div><!-- /content -->

		<div data-role="footer" class="nav-glyphish-example" data-position="fixed" data-tap-toggle="false">
			<div data-role="navbar" class="nav-glyphish-example" data-grid="c">
			<ul>
				<li><a href="#page-event" data-transition="none" id="event" onclick="pullUserEvent();">Activity</a></li>
				<li><a href="#page-friend" data-transition="none" id="friend" onclick="pullMyFriendList();">Friend</a></li>
				<li><a href="#page-chat" data-transition="none" class="chat-active-custom" id="chat" onclick="pullMyChat();">Chat</a></li>
				<li><a href="#page-setting" data-transition="none" id="setting">Setting</a></li>
			</ul>
			</div>
		</div><!-- /footer -->
	</div><!-- /page -->

	<!-- Page for displaying the messages of a chat -->
	<div data-role="page" id="page-chat-messages" data-transition="none" data-title="觅校缘" data-add-back-btn="true">

		<div data-role="header" data-position="fixed" data-tap-toggle="false" >
			<h1 id='chat-messages-title'></h1>
			<a data-rel="back" href="#page-event" class="ui-btn-left ui-btn ui-btn-inline ui-corner-all" onclick="pullMyChat(); $('#send-message-bar').fadeOut()">Back</a>
		</div><!-- /header -->

		<div role="main" class="ui-content" style="margin-bottom:100px">
		</div><!-- /content -->

		<div data-role="footer" data-position="fixed" data-tap-toggle="false" >
		</div><!-- /footer -->

	</div><!-- /page -->

	<!-- Page for displaying setting options -->
	<div data-role="page" id="page-setting" data-title="觅校缘">

		<div data-role="header">
			<h1>Setting</h1>
		</div><!-- /header -->

		<div role="main" class="ui-content">
			<a href="#page-edit-my-profile" class="ui-btn" onclick="getMyProfile(); $('#profile-save-btn').on('click', function(){saveProfile()});">Edit My Profile</a>
			<button class="ui-btn ui-custom-log-out" onclick="logout();">Logout</button>
		</div><!-- /content -->

		<div data-role="footer" class="nav-glyphish-example" data-position="fixed" data-tap-toggle="false">
			<div data-role="navbar" class="nav-glyphish-example" data-grid="c">
			<ul>
				<li><a href="#page-event" data-transition="none" id="event" onclick="pullUserEvent();">Activity</a></li>
				<li><a href="#page-friend" data-transition="none" id="friend" onclick="pullMyFriendList();">Friend</a></li>
				<li><a href="#page-chat" data-transition="none" id="chat" onclick="pullMyChat();">Chat</a></li>
				<li><a href="#page-setting" data-transition="none" class="setting-active-custom" id="setting">Setting</a></li>
			</ul>
			</div>
		</div><!-- /footer -->
	</div><!-- /page -->

	<!-- Page for displaying edit my profile -->
	<div data-role="page" id="page-edit-my-profile" data-title="觅校缘">

		<div data-role="header">
			<h1>My Profile</h1>
			<a data-rel="back" href="#page-event" class="ui-btn-left ui-btn ui-btn-inline ui-corner-all" onclick="refreshPreviewPhoto = false;">Back</a>
			<a data-rel="back" href="#page-event" class="ui-btn-right ui-btn ui-btn-inline ui-corner-all" id="profile-save-btn" onclick="saveProfile();">Save</a>
		</div><!-- /header -->

		<div role="main" class="ui-content" id="my-profile">
			<div class="profile-photo-bar">
				<label style='padding-left: 1em;' for="profilephoto">Photo:</label>
				<canvas id="canvas-photo" class="profile-photo-preview" width="120px" height="120px"></canvas>
				<input type="file" data-clear-btn="false" name="profilephoto" id="profile-edit-photo" onchange="profilePhotoCrop()" value="">
			</div>
			<form style='padding: 1em;'>
				<label for="profileusername">Name:</label>
				<input type="text" data-clear-btn="true" name="profilename" id="profile-edit-name" value="">
				<label for="eventlocation">Gender:</label>
				<select name="profilegender" id="profile-edit-gender" data-role="flipswitch" data-wrapper-class="custom-size-flipswitch-event-create-visibility" checked="">
					<option value="off">Female</option>
					<option value="on" selected="">Male</option>
				</select>
				<label for="profilebirthdate">Birthdate:</label>
				<input type="date" data-role="date" name="profilebirthdate" id="profile-edit-birthdate">
				<label for="profilemotto">Motto:</label>
				<input type="text" data-clear-btn="true" name="profilemotto" id="profile-edit-motto" value="">
				<label for="profileschool">School:</label>
				<input type="text" data-clear-btn="true" name="profileuschool" id="profile-edit-school" value="">
				<label for="profilemajor">Major:</label>
				<input type="text" data-clear-btn="true" name="profilemajor" id="profile-edit-major" value="">
				<label for="profileinterest">Interest:</label>
				<input type="text" data-clear-btn="true" name="profileinterest" id="profile-edit-interest" value="">
				<label for="profilelocation">Location:</label>
				<input type="text" data-clear-btn="true" name="profilelocation" id="profile-edit-location" value="">
			</form>
		</div><!-- /content -->

		<div data-role="footer" data-position="fixed" data-tap-toggle="false">
		</div><!-- /footer -->
	</div><!-- /page -->



		<div id="send-comment-bar" class="ui-footer ui-bar-inherit ui-footer-fixed slideup ui-page-theme-a" style="z-index:2; display:none">
			<div class="rwd-example ui-footer ui-bar-inherit ui-footer-fixed slideup" style="position:fixed; bottom:0px">
				<form id="comment-form">
					<label id="event-id-label" class="ui-hidden-accessible"></label>
					<div class="custom-block-a" onclick="sendToolbarActiveKeyboard('comment-content')">
						<div class="ui-input-text ui-shadow-inset ui-focus ui-body-inherit ui-corner-all">
							<input type="text" name="commentcontent" id="comment-content" value="">
						</div>
					</div>
					<div class="custom-block-b">
						<button id="send-comment-button" class="ui-btn ui-corner-all custom-send-button" onclick="sendCommnet();">Send</button>
					</div>
				</form>
			</div>
		</div>

		<div id="send-message-bar" class="ui-footer ui-bar-inherit ui-footer-fixed slideup ui-page-theme-a" style="z-index:3; display:none">
			<div class="rwd-example ui-footer ui-bar-inherit ui-footer-fixed slideup" style="position:fixed; bottom:0px">
				<form id='message-chat-form'>
					<label id="group-id-label" class="ui-hidden-accessible"></label>
					<div class="custom-block-a" onclick="sendToolbarActiveKeyboard('message-content')">
						<div class="ui-input-text ui-shadow-inset ui-focus ui-body-inherit ui-corner-all">
							<input type="text" name="messagecontent" id="message-content" value="">
						</div>
					</div>
					<div class="custom-block-b">
						<button id="send-message-button" class="ui-btn ui-corner-all custom-send-button" onclick="sendMessage();">Send</button>
					</div>
				</form>
			</div>
		</div>

	<script type="text/javascript">
        app.initialize();
    </script>

</body>
</html>