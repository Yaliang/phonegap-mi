touch={touchInitialize:function(t,e){this.topOverPixel=0,this.selector=t,$(this.selector).stop(),this.stop=!0,0==$(this.selector).children(".touch-scroll-bar").length&&$(this.selector).prepend("<div class='touch-scroll-bar'></div>"),this.scrollBarElement=$(this.selector).children(".touch-scroll-bar"),this.touchHideScrollBar(),$(this.selector).unbind("touchstart").bind("touchstart",function(t){touch.touchStartEventHandler(t),touch.touchShowScrollBar(),touch.touchUpdateScrollBar()}),$(this.selector).unbind("touchmove").bind("touchmove",function(t){touch.touchMoveEventHandler(t),touch.touchUpdateScrollBar()}),$(this.selector).unbind("touchend").bind("touchend",function(t){touch.touchEndEventHandler(t)}),"undefined"!=typeof e?(this.pullTopFunc=e,this.pullTopEnable=!0,0==$(this.selector).children(".touch-top-pull-bar").length&&$(this.selector).prepend("<div class='touch-top-pull-bar'>Pull to load</div>")):this.pullTopEnable=!1},touchStartEventHandler:function(t){$(this.selector).stop(),this.stop=!0,this.currentY=t.originalEvent.touches[0].clientY,this.moveStartY=this.currentY,this.moveStartTime=new Date,this.moveSlowCircle=0},touchMoveEventHandler:function(t){t.preventDefault(),this.lastY=this.currentY,this.currentY=t.originalEvent.touches[0].clientY,this.moveRate=1+Math.round(Math.abs(this.currentY-this.lastY)/10),this.moveRate>1?this.moveSlowCircle=0:this.moveSlowCircle+=1;var e=$(this.selector).scrollTop()-(this.currentY-this.lastY);$(this.selector).scrollTop(e),0==$(this.selector).scrollTop()&&this.pullTopEnable&&(this.topOverPixel=Math.max(0,this.topOverPixel+Math.round(1/(1*this.topOverPixel/20+1)*(this.currentY-this.lastY))),$(this.selector).children(".touch-top-pull-bar").height(Math.min(this.topOverPixel,60)),this.topOverPixel>=40&&$(this.selector).children(".touch-top-pull-bar").html("Release to load"))},touchEndEventHandler:function(t){return this.pullTopEnable&&this.topOverPixel>=40?(this.pullTopFunc(),this.topOverPixel=30,$(this.selector).children(".touch-top-pull-bar").animate({height:30},300),$(this.selector).children(".touch-top-pull-bar").html("Loading")):(this.topOverPixel=0,$(this.selector).children(".touch-top-pull-bar").animate({height:0},300),$(this.selector).children(".touch-top-pull-bar").html("Pull to load")),this.moveSlowCircle>5?void touch.touchHideScrollBar():(this.moveEndTime=new Date,this.moveRate=1*(this.currentY-this.moveStartY)/(this.moveEndTime-this.moveStartTime)*30,this.stop=!1,void this.touchEndAnimate())},touchEndAnimate:function(){return this.moveRate=19*this.moveRate/20,Math.abs(this.moveRate)<1?void touch.touchHideScrollBar():($(this.selector).scrollTop(1*$(this.selector).scrollTop()-this.moveRate),this.touchUpdateScrollBar(),void setTimeout(function(){touch.stop||touch.touchEndAnimate()},13))},touchShowScrollBar:function(){var t=$(this.selector)[0].scrollHeight,e=$(this.selector).height();t>e&&this.scrollBarElement.fadeIn()},touchHideScrollBar:function(){this.scrollBarElement.fadeOut()},touchDestroyScollBar:function(){this.scrollBarElement.remove()},touchUpdateScrollBar:function(){var t=$(this.selector)[0].scrollHeight,e=$(this.selector).height(),o=$(this.selector).scrollTop(),l=$(this.selector).offset().top+Math.round(1*o/t*e);this.scrollBarElement.height(Math.round(1*e*e/t-this.topOverPixel)),this.scrollBarElement.offset({top:l,right:10})},touchHideTopLoadingBar:function(){this.topOverPixel=0,$(this.selector).children(".touch-top-pull-bar").animate({height:0},300,function(){$(touch.selector).children(".touch-top-pull-bar").html("Pull to load")})}};