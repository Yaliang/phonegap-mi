function loadedImage(t,e){return this.selector=t,this.controller=$(this.selector)[0],"undefined"==typeof e?this.file_index=0:this.file_index=e,this.reader=new FileReader,this.get_file=function(){return this.controller.files.length<=this.file_index?!1:(this.file=this.controller.files[this.file_index],"undefined"==typeof this.file?!1:!0)},this.parseEXIFdata=function(t,e){return this.get_file()?(this.image_ready=!1,this.reader.onload=function(t,e,i){return function(a){var h=new Image;h.src=a.target.result,t.image=h,t.image_ready=!0,t.src=h.src,image_with_exif=EXIF.getData(h,function(){}),t.exifdata=image_with_exif.exifdata,"undefined"!=typeof e&&(i.self=t,e(i))}}(this,t,e),this.reader.readAsDataURL(this.file),!0):!1},this.crop_into_canvas_and_image=function(t){if(!("width"in t&&"height"in t))return!1;this.canvas_ready=!1,$("#body-input-create-event-description").append("canvas_ready set false</br>");var e=function(e){var i=e.self,a=i.image,h=document.createElement("canvas"),r=i.exifdata.Orientation;console.log(r);var n=0,s=0,d=0,g=0,o=i.image.width,l=i.image.height,f=t.width,c=t.height;h.width=t.width,h.height=t.height,o>l?(f=o*(c/l),d=(h.width-f)/2):l>o&&(c=l*(f/o),g=(h.height-c)/2);var w=h.getContext("2d");switch(r){case 8:w.translate(h.width/2,h.height/2),w.rotate(-90*Math.PI/180),w.drawImage(a,n,s,o,l,d-h.width/2,g-h.height/2,f,c),w.rotate(90*Math.PI/180),w.translate(-h.width/2,-h.height/2);break;case 3:w.translate(h.width/2,h.height/2),w.rotate(180*Math.PI/180),w.drawImage(a,n,s,o,l,d-h.width/2,g-h.height/2,f,c),w.rotate(-180*Math.PI/180),w.translate(-h.width/2,-h.height/2);break;case 6:w.translate(h.width/2,h.height/2),w.rotate(90*Math.PI/180),w.drawImage(a,n,s,o,l,d-h.width/2,g-h.height/2,f,c),w.rotate(-90*Math.PI/180),w.translate(-h.width/2,-h.height/2);break;default:w.drawImage(a,n,s,o,l,d,g,f,c)}i.canvas=h;var u=new Image;u.src=h.toDataURL(),u.width=t.width,u.height=t.height,i.cropped_image=u,i.canvas_ready=!0};return this.parseEXIFdata(e,t),!0},this}